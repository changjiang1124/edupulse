# EduPulse 項目實施計劃

## 項目概述

EduPulse 是一個基於 Django 的藝術學校管理系統，用於替代 Perth Art School 當前的 WordPress + WooCommerce 系統，主要處理課程管理和學生註冊功能。

## 技術架構

### 後端技術棧
- **框架**: Django 5.2.5
- **資料庫**: SQLite (開發環境)
- **認證**: 自定義 Staff 用戶模型
- **郵件服務**: Amazon SES
- **簡訊服務**: Twilio
- **環境變量**: python-dotenv

### 前端技術棧  
- **CSS 框架**: Bootstrap 5
- **JavaScript**: jQuery 3.6+
- **樣式**: 現代化簡約設計，統一色彩方案
- **代碼組織**: 分離的 CSS/JS 文件，避免內聯代碼

### 部署環境
- **域名**: https://edupulse.perthartschool.com.au/
- **支付**: 銀行轉帳/線下支付 (避免支付網關費用)

## MVP 階段實施計劃

### 第一階段：項目基礎搭建 ✅ 已完成

#### 1.1 環境設置
- [x] 創建 Django 項目和核心應用
- [x] 配置 settings.py 
- [x] 設置靜態文件處理
- [x] 配置 URL 路由

#### 1.2 前端框架配置  
- [x] 集成 Bootstrap 5
- [x] 實現現代化簡約設計主題
- [x] 配置 jQuery 庫
- [x] 創建基礎模板結構 (base.html)
- [x] 實現響應式導航欄

### 第二階段：資料庫設計與模型 ✅ 已完成

#### 2.1 核心資料模型
- [x] **設施模型**: Facility  
- [x] **教室模型**: Classroom
- [x] **員工模型**: Staff (擴展 AbstractUser)
- [x] **學生模型**: Student (包含監護人信息)

#### 2.2 課程管理模型
- [x] **課程模型**: Course (包含 description, short_description)
- [x] **班級模型**: Class (1:n 關係與 Course)
- [x] **註冊模型**: Enrollment
- [x] **考勤模型**: Attendance
- [x] **打卡模型**: ClockInOut

#### 2.3 通信模型
- [x] **郵件記錄模型**: EmailLog
- [x] **簡訊記錄模型**: SMSLog

### 第三階段：課程管理系統 ✅ 已完成

#### 3.1 課程與班級關係
- [x] 實現 Course 與 Class 的 1:n 關係
- [x] Course 模型包含 description 和 short_description 字段
- [x] 班級可根據課程排程自動生成 (支持重複模式)

#### 3.2 課程管理界面
- [x] 課程列表頁面 (core/courses/list.html)
- [x] 課程添加/編輯表單 (core/courses/form.html) 
- [x] 課程詳情頁面 (core/courses/detail.html)
- [x] 所有課程相關 URL 和視圖已配置

#### 3.3 導航和用戶界面
- [x] 修復導航選單中的課程鏈接
- [x] 實現現代化簡約設計
- [x] 移除多餘圖標，保持界面簡潔
- [x] 統一顏色方案和現代化樣式

### 第四階段：用戶管理與權限 ✅ 已完成

#### 4.1 員工管理系統
- [x] 員工信息管理界面
- [x] 角色權限控制 (管理員/教師)  
- [x] 員工狀態管理
- [x] 員工表單 Bootstrap 樣式優化

#### 4.2 學生管理系統
- [x] 學生信息 CRUD 操作
- [x] 監護人信息管理
- [x] 學生狀態管理
- [x] 學生表單 Bootstrap 樣式優化
- [x] 學生列表頁面，支持搜索功能
- [x] 學生詳情頁面，顯示註冊和出勤記錄

#### 4.3 設施與教室管理
- [x] 設施（Facility）管理系統
- [x] 教室（Classroom）管理系統，1:n 關係與設施
- [x] 教室 CRUD 操作和導航菜單整合
- [x] 教室狀態管理和篩選功能
- [x] **修復**: 教室創建表單 is_active 字段顯示問題

#### 4.4 儀表板功能
- [x] 管理員儀表板視圖
- [x] 統計資料顯示
- [x] 近期課程和註冊信息

#### 4.5 表單系統優化 ✅ 已完成
- [x] **Django 表單類創建**: 所有模型的自定義表單類，包含 Bootstrap CSS 類
- [x] **Bootstrap 樣式集成**: 完整的 Bootstrap 5 樣式支持和對齊
- [x] **表單驗證增強**: 改進的錯誤顯示和驗證反饋
- [x] **一致的表單佈局**: 統一的表單設計和用戶體驗
- [x] **響應式設計**: 所有表單在移動設備上正確顯示
- [x] **CSS 增強**: 完善的表單樣式，包括焦點狀態、驗證狀態等
- [x] **所有模組表單模板**: 課程、學生、員工、設施、教室表單模板已完成

#### 4.6 富文本編輯器系統 ✅ 已完成
- [x] **TinyMCE 集成**: 替換 CKEditor，使用自托管方案避免 API 金鑰需求
- [x] **圖片上傳功能**: 安全的圖片上傳，支持課程描述圖片插入
- [x] **WordPress 兼容**: 簡化工具欄，確保與 WordPress/WooCommerce 同步兼容
- [x] **安全驗證**: 文件類型和大小限制，UUID 命名防止衝突
- [x] **檔案組織**: 按日期組織的目錄結構 (YYYY/MM)

### 第五階段：註冊與考勤系統 ✅ 已完成

#### 5.1 註冊系統
- [x] **完整的 CRUD 系統**: 註冊的創建、讀取、更新、刪除功能
- [x] **內部管理界面**: 工作人員使用的註冊管理系統
- [x] **公開註冊表單**: 無需認證的學生/監護人註冊頁面
- [x] **智能學生管理**: 自動創建或更新現有學生資料
- [x] **註冊狀態管理**: pending/confirmed/cancelled 狀態流程
- [x] **註冊來源跟蹤**: website/form/staff 來源記錄
- [x] **表單資料保存**: 原始註冊表單資料的 JSON 儲存
- [x] **重複註冊檢測**: 防止同一學生重複註冊相同課程
- [x] **成功頁面引導**: 註冊成功後的後續步驟說明

#### 5.2 註冊表單功能
- [x] **學生資訊收集**: 姓名、聯絡方式、出生日期、地址
- [x] **監護人資訊**: 針對未成年學生的監護人資料（動態驗證）
- [x] **緊急聯絡人**: 緊急情況聯絡資訊
- [x] **醫療資訊**: 醫療條件和特殊需求記錄
- [x] **課程選擇**: 動態課程列表，顯示價格資訊
- [x] **表單驗證**: 前端和後端雙重驗證
- [x] **響應式設計**: 移動設備友好的表單界面

#### 5.3 註冊管理功能
- [x] **篩選功能**: 按學生、課程、狀態篩選註冊記錄
- [x] **快速操作**: 確認註冊、編輯、刪除等快速操作
- [x] **詳細視圖**: 完整的註冊資訊顯示，包含學生和課程詳情
- [x] **相關資料**: 顯示學生的其他註冊記錄
- [x] **緊急聯絡資訊**: 側邊欄顯示監護人和緊急聯絡人資訊
- [x] **原始資料追蹤**: 表單提交的原始資料查看功能

#### 5.4 URL 配置和路由
- [x] **公開註冊路由**: `/enroll/` 無需認證即可訪問
- [x] **管理功能路由**: `/enrollment/` 需要認證的管理功能
- [x] **命名空間管理**: 避免 URL 命名衝突的 namespace 配置
- [x] **導航菜單整合**: 在主導航中添加註冊管理鏈接

#### 5.5 考勤管理 📋 部分完成
- [x] **考勤模型**: Attendance 模型和資料庫結構
- [x] **考勤錄入頁面**: AttendanceMarkView 基礎頁面
- [ ] 教師考勤錄入界面完善
- [ ] 學生出勤狀態記錄
- [ ] 考勤報表生成
- [ ] 缺勤自動通知

#### 5.6 打卡系統 📋 待開始
- [ ] GPS 位置驗證
- [ ] 上下班打卡記錄
- [ ] 工時統計和導出功能

### 第六階段：通知系統 📧 待開始

#### 6.1 郵件服務
- [ ] Amazon SES 郵件服務集成
- [ ] 自動化郵件模板
- [ ] 郵件日志記錄

#### 6.2 簡訊服務
- [ ] Twilio 簡訊服務集成  
- [ ] 簡訊通知模板
- [ ] 簡訊日志記錄

### 第七階段：WooCommerce 集成 🔗 待開始

#### 7.1 API 集成
- [ ] 課程信息同步 API
- [ ] 註冊狀態同步
- [ ] 雙向數據同步機制
- [ ] 錯誤處理和重試機制

#### 7.2 外部集成
- [ ] 支付狀態回調處理
- [ ] 網站重定向配置
- [ ] 數據一致性檢查

### 第八階段：系統重構 ✅ 已完成

#### 8.1 應用模組化
- [x] **重構為模組化架構**: 將單一 core 應用拆分為專業化應用
- [x] **accounts 應用**: Staff 模型和用戶認證管理
- [x] **students 應用**: Student 模型和學生管理功能
- [x] **academics 應用**: Course 和 Class 模型，課程管理功能  
- [x] **facilities 應用**: Facility 和 Classroom 模型，設施管理功能
- [x] **enrollment 應用**: Enrollment 和 Attendance 模型，註冊和考勤功能

#### 8.2 資料庫遷移和重構
- [x] **模型遷移**: 所有模型成功遷移到對應應用
- [x] **自定義用戶模型**: 將 AUTH_USER_MODEL 更新為 accounts.Staff
- [x] **外鍵關係**: 跨應用模型關係正確配置
- [x] **資料庫重建**: 解決遷移歷史衝突，重新建立乾淨的資料庫結構

#### 8.3 代碼組織優化
- [x] **views 拆分**: 將 views 按功能分配到各個應用
- [x] **forms 拆分**: 創建各應用專屬的 forms.py 文件
- [x] **admin 配置**: 各應用獨立的 admin.py 配置
- [x] **URL 路由**: 模組化 URL 配置，namespace 管理
- [x] **templates 重組**: 按應用組織模板文件結構

#### 8.4 測試與驗證
- [x] **模型創建測試**: 所有模型可正常創建和關聯
- [x] **URL 路由測試**: 所有路由響應正確的 HTTP 狀態碼
- [x] **管理命令測試**: Django 管理命令正常執行
- [x] **外鍵關係測試**: 跨應用模型關係正常工作
- [x] **服務器運行測試**: 開發服務器正常啟動和響應

### 第九階段：系統優化與部署 🚀 待開始

#### 9.1 測試與優化
- [ ] 系統測試
- [ ] 性能優化
- [ ] 安全檢查

#### 9.2 生產部署
- [ ] 服務器環境配置
- [ ] SSL 證書配置
- [ ] 數據備份策略

## 當前進度總結 📊

### ✅ 已完成的功能
1. **基础架构**: Django 项目设置、数据库模型设计
2. **用户界面**: 现代化简约设计、统一色彩方案
3. **课程管理**: 完整的课程 CRUD 操作，支持 TinyMCE 富文本编辑
4. **用户管理**: 员工和学生管理系统，包含详细信息页面
5. **设施管理**: 设施与教室管理，1:n 关系实现
6. **数据模型**: 完整的学校管理系统数据结构
7. **表单系统**: Bootstrap 5 集成、一致的表单样式
8. **富文本编辑器**: TinyMCE 自托管方案，支持图片上传
9. **问题修复**: 教室创建表单状态字段显示问题已解决
10. **模組化重構**: 成功將單一核心應用重構為5個專業化應用
11. **資料庫遷移**: 完成 AUTH_USER_MODEL 變更和跨應用模型遷移
12. **功能驗證**: 所有模型、關係和基礎功能測試通過
13. **註冊系統**: 完整的註冊 CRUD 系統，包含公開註冊表單和內部管理界面

### 🔄 下一步重点任务
1. **考勤功能完善**: 完善教師考勤錄入界面和報表功能
2. **通知系統**: 集成郵件和簡訊服務，實現自動化通知
3. **WooCommerce 同步**: 建立與現有網站的數據同步
4. **系統測試**: 全面的功能測試和性能優化

### 📋 技术债务和改进计划
1. ~~需要创建更多模板文件 (学生、员工管理页面)~~ ✅ 已完成
2. ~~添加表单验证和错误处理~~ ✅ 已完成
3. ~~实现统一的 Bootstrap 表单样式~~ ✅ 已完成
4. ~~Course 描述字段添加富文本编辑器支持~~ ✅ 已完成
5. 实现数据分页和搜索功能
6. 添加单元测试
7. 创建缺失的列表和详情页面模板
8. 考虑升级到 CKEditor 5 以解决安全问题

## 開發標準

### 代碼質量
- 遵循 Django 最佳實踐
- 澳洲英語界面，中文註釋
- 模組化和可維護性
- 避免內聯 CSS/JS

### 設計原則
- 現代化簡約設計
- 統一色彩方案 (主色: #2563eb)
- 最少化圖標使用
- 專業的藝術學校管理系統外觀

---

*最後更新時間: 2025-08-30*
*版本: v3.0*
*當前階段: 註冊系統已完成，考勤功能開發中*