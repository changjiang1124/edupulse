{% extends 'base.html' %}
{% load static %}

{% block title %}{{ page_title }} - Perth Art School{% endblock %}

{% block extra_css %}
<style>
    .settings-card {
        border: none;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        border-radius: 12px;
    }
    .settings-header {
        background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
        color: white;
        border-radius: 12px 12px 0 0;
        padding: 20px 30px;
    }
    .gst-calculator {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
    }
    .form-check-input:checked {
        background-color: #2563eb;
        border-color: #2563eb;
    }
    .btn-test {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        border: none;
        color: white;
    }
    .btn-test:hover {
        background: linear-gradient(135deg, #059669 0%, #047857 100%);
    }
    .calculation-result {
        background: #f0fdf4;
        border: 1px solid #22c55e;
        border-radius: 6px;
        padding: 15px;
        margin-top: 15px;
    }
    .gst-preview {
        font-family: 'Courier New', monospace;
        background: #1f2937;
        color: #f9fafb;
        padding: 15px;
        border-radius: 6px;
        font-size: 14px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="h3 mb-0">Organisation Settings</h1>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="{% url 'core:dashboard' %}">Dashboard</a></li>
                        <li class="breadcrumb-item active">Organisation Settings</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>

    <form method="post">
        {% csrf_token %}
        
        <div class="row">
            <!-- Organisation Details -->
            <div class="col-lg-6">
                <div class="card settings-card mb-4">
                    <div class="settings-header">
                        <h5 class="mb-0"><i class="bi bi-building me-2"></i>Organisation Details</h5>
                    </div>
                    <div class="card-body p-4">
                        <div class="mb-3">
                            <label for="organisation_name" class="form-label">Organisation Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="organisation_name" name="organisation_name" 
                                   value="{{ org_settings.organisation_name }}" required>
                            <div class="form-text">Legal name of your organisation</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="abn_number" class="form-label">ABN Number</label>
                            <input type="text" class="form-control" id="abn_number" name="abn_number" 
                                   value="{{ org_settings.abn_number }}" placeholder="11 123 456 789">
                            <div class="form-text">Australian Business Number (if applicable)</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="contact_email" class="form-label">Contact Email <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="contact_email" name="contact_email" 
                                   value="{{ org_settings.contact_email }}" required>
                        </div>
                        
                        <div class="mb-0">
                            <label for="contact_phone" class="form-label">Contact Phone <span class="text-danger">*</span></label>
                            <input type="tel" class="form-control" id="contact_phone" name="contact_phone" 
                                   value="{{ org_settings.contact_phone }}" required>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- GST Configuration -->
            <div class="col-lg-6">
                <div class="card settings-card mb-4">
                    <div class="settings-header">
                        <h5 class="mb-0"><i class="bi bi-calculator me-2"></i>GST Configuration</h5>
                    </div>
                    <div class="card-body p-4">
                        <div class="mb-0">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="prices_include_gst" name="prices_include_gst" 
                                       {% if org_settings.prices_include_gst %}checked{% endif %}>
                                <label class="form-check-label" for="prices_include_gst">
                                    <strong>Prices Include GST</strong>
                                </label>
                            </div>
                            <div class="form-text">When enabled, all displayed prices include GST (10%). When disabled, GST will be added to displayed prices at checkout.</div>
                            
                            <div class="alert alert-info mt-3">
                                <i class="bi bi-info-circle me-2"></i>
                                <strong>Note:</strong> GST is automatically calculated at the standard Australian rate of 10%. This setting only controls whether your displayed prices include or exclude GST.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        

        
        <!-- Save Button -->
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-end gap-2">
                    <a href="{% url 'core:dashboard' %}" class="btn btn-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-check-lg me-2"></i>Save Settings
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Simple form validation for organisation settings
    const form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function(e) {
            // Basic validation can be added here if needed
            console.log('Organisation settings form submitted');
        });
    }
});
</script>
{% endblock %}